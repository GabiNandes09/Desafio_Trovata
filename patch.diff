From 306d75fde2c3dee9c459855189f48cbbf25fda87 Mon Sep 17 00:00:00 2001
From: Gabriel Fernandes <fernandes.gabrielgon@gmail.com>
Date: Thu, 30 May 2024 17:59:11 -0300
Subject: [PATCH] =?UTF-8?q?Ordena=C3=A7=C3=A3o=20A-Z,=20Z-A,=20C=C3=B3digo?=
 =?UTF-8?q?=20funcionando?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 .idea/misc.xml                                |  1 -
 app/src/main/java/DAO/ProdutoDAO.java         |  4 +-
 .../desafio_trovata/ListaAdapter.java         |  5 ++
 .../desafio_trovata/ProductListActivity.java  | 55 +++++++++++++++++--
 .../main/res/layout-land/activity_list.xml    |  7 +++
 app/src/main/res/layout/activity_list.xml     | 22 +++++++-
 6 files changed, 83 insertions(+), 11 deletions(-)

diff --git a/.idea/misc.xml b/.idea/misc.xml
index 0ad17cb..8978d23 100644
--- a/.idea/misc.xml
+++ b/.idea/misc.xml
@@ -1,4 +1,3 @@
-<?xml version="1.0" encoding="UTF-8"?>
 <project version="4">
   <component name="ExternalStorageConfigurationManager" enabled="true" />
   <component name="ProjectRootManager" version="2" languageLevel="JDK_17" default="true" project-jdk-name="jbr-17" project-jdk-type="JavaSDK">
diff --git a/app/src/main/java/DAO/ProdutoDAO.java b/app/src/main/java/DAO/ProdutoDAO.java
index 6c19386..c566916 100644
--- a/app/src/main/java/DAO/ProdutoDAO.java
+++ b/app/src/main/java/DAO/ProdutoDAO.java
@@ -33,10 +33,10 @@ public class ProdutoDAO {
         dbHelper.close();
     }
 
-    public List<Produto> getAllProdutos(int id){
+    public List<Produto> getAllProdutos(int id, String ordem){
         List<Produto> produtos = new ArrayList<>();
         Cursor cursor = database.query(DatabaseHelper.TABLE_PRODUTO, null, DatabaseHelper.COLUMN_PRODUTO_EMPRESA +"=" + id,
-                null, null, null, null);
+                null, null, null, ordem);
 
         if (cursor.moveToFirst()){
             Log.i("NTESTE", "Entoru no if");
diff --git a/app/src/main/java/com/gabrielfernandes/desafio_trovata/ListaAdapter.java b/app/src/main/java/com/gabrielfernandes/desafio_trovata/ListaAdapter.java
index b5aea04..3400e21 100644
--- a/app/src/main/java/com/gabrielfernandes/desafio_trovata/ListaAdapter.java
+++ b/app/src/main/java/com/gabrielfernandes/desafio_trovata/ListaAdapter.java
@@ -57,5 +57,10 @@ public class ListaAdapter extends RecyclerView.Adapter<ListaAdapter.ListaViewHol
         return produtos.size();
     }
 
+    public void updateData(List<Produto> newProdutos) {
+        this.produtos = newProdutos;
+        notifyDataSetChanged();
+    }
+
 }
 
diff --git a/app/src/main/java/com/gabrielfernandes/desafio_trovata/ProductListActivity.java b/app/src/main/java/com/gabrielfernandes/desafio_trovata/ProductListActivity.java
index 6ba3426..4865a8c 100644
--- a/app/src/main/java/com/gabrielfernandes/desafio_trovata/ProductListActivity.java
+++ b/app/src/main/java/com/gabrielfernandes/desafio_trovata/ProductListActivity.java
@@ -2,6 +2,10 @@ package com.gabrielfernandes.desafio_trovata;
 
 import android.os.Bundle;
 import android.util.Log;
+import android.view.View;
+import android.widget.AdapterView;
+import android.widget.ArrayAdapter;
+import android.widget.Spinner;
 import android.widget.TextView;
 
 import androidx.appcompat.app.AppCompatActivity;
@@ -13,12 +17,15 @@ import java.util.Arrays;
 import java.util.List;
 
 import DAO.ProdutoDAO;
+import Database.DatabaseHelper;
+import Models.Empresa;
 import Models.Produto;
 
 public class ProductListActivity extends AppCompatActivity {
 
     TextView txtNomeEmpresa;
     RecyclerView rvProdutos;
+    Spinner spFiltro;
 
     ProdutoDAO produtoDAO;
 
@@ -26,18 +33,54 @@ public class ProductListActivity extends AppCompatActivity {
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         setContentView(R.layout.activity_list);
-        produtoDAO = new ProdutoDAO(this);
-        Bundle bundle = getIntent().getExtras();
-        List<Produto> produtos = produtoDAO.getAllProdutos(bundle.getInt("ID"));
+
+        spFiltro = findViewById(R.id.spFiltro);
         txtNomeEmpresa = findViewById(R.id.txtNomeEmpresa);
         rvProdutos = findViewById(R.id.rvProdutos);
-        ListaAdapter adapter = new ListaAdapter(produtos);
+
+        String[] filtros = {"A - Z", "Z - A", "Código"};
+        ArrayAdapter<String> adapterFiltro = new ArrayAdapter<>(this,
+                android.R.layout.simple_spinner_item, filtros);
+        adapterFiltro.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
+        spFiltro.setAdapter(adapterFiltro);
+
+        final String[] ordem = {DatabaseHelper.COLUMN_PRODUTO_DESCRICAO + " ASC"};
+
+        produtoDAO = new ProdutoDAO(this);
+        Bundle bundle = getIntent().getExtras();
+        final List<Produto>[] produtos = new List[]{produtoDAO.getAllProdutos(bundle.getInt("ID"), ordem[0])};
+
+        ListaAdapter adapter = new ListaAdapter(produtos[0]);
+
         rvProdutos.setAdapter(adapter);
         rvProdutos.setLayoutManager(new LinearLayoutManager(this));
+
         if (bundle != null){
             txtNomeEmpresa.setText(bundle.getString("Nome"));
         }
-
-
+        spFiltro.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
+            @Override
+            public void onItemSelected(AdapterView<?> parent, View view, int position, long id) {
+                switch (spFiltro.getSelectedItem().toString()){
+                    case "A - Z":
+                        ordem[0] = DatabaseHelper.COLUMN_PRODUTO_DESCRICAO + " ASC";
+                        break;
+                    case "Z - A":
+                        ordem[0] = DatabaseHelper.COLUMN_PRODUTO_DESCRICAO + " DESC";
+                        break;
+                    case "Código":
+                        ordem[0] = DatabaseHelper.COLUMN_PRODUTO_PRODUTO + " ASC";
+                        break;
+                    default:
+                        throw new IllegalStateException("Unexpected value: " + spFiltro.getSelectedItem().toString());
+                }
+                produtos[0] = produtoDAO.getAllProdutos(bundle.getInt("ID"), ordem[0]);
+                adapter.updateData(produtos[0]);
+            }
+            @Override
+            public void onNothingSelected(AdapterView<?> parent) {
+                ordem[0] = DatabaseHelper.COLUMN_PRODUTO_DESCRICAO + " ASC";
+            }
+        });
     }
 }
diff --git a/app/src/main/res/layout-land/activity_list.xml b/app/src/main/res/layout-land/activity_list.xml
index 3e75c43..a17642f 100644
--- a/app/src/main/res/layout-land/activity_list.xml
+++ b/app/src/main/res/layout-land/activity_list.xml
@@ -5,6 +5,13 @@
     android:layout_width="match_parent"
     android:layout_height="wrap_content">
 
+    <Spinner
+        android:id="@+id/spFiltro"
+        android:layout_width="0dp"
+        android:layout_height="48dp"
+        tools:layout_editor_absoluteX="436dp"
+        tools:layout_editor_absoluteY="165dp" />
+
     <ImageView
         android:id="@+id/imageView2"
         android:layout_width="wrap_content"
diff --git a/app/src/main/res/layout/activity_list.xml b/app/src/main/res/layout/activity_list.xml
index f233f4f..199f961 100644
--- a/app/src/main/res/layout/activity_list.xml
+++ b/app/src/main/res/layout/activity_list.xml
@@ -21,12 +21,12 @@
         android:layout_width="0dp"
         android:layout_height="240dp"
         android:layout_marginStart="8dp"
-        android:layout_marginTop="20dp"
+        android:layout_marginTop="8dp"
         android:layout_marginEnd="8dp"
         app:layout_constraintEnd_toEndOf="parent"
         app:layout_constraintHorizontal_bias="0.0"
         app:layout_constraintStart_toStartOf="parent"
-        app:layout_constraintTop_toBottomOf="@+id/txtNomeEmpresa"
+        app:layout_constraintTop_toBottomOf="@+id/spFiltro"
         tools:itemCount="5"
         tools:listitem="@layout/item_list" />
 
@@ -57,4 +57,22 @@
         app:layout_constraintStart_toStartOf="parent"
         app:layout_constraintTop_toBottomOf="@+id/imageView2" />
 
+    <ImageView
+        android:id="@+id/imageView3"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_marginStart="16dp"
+        app:layout_constraintBottom_toBottomOf="@+id/spFiltro"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintTop_toTopOf="@+id/spFiltro"
+        app:srcCompat="@android:drawable/ic_menu_info_details" />
+
+    <Spinner
+        android:id="@+id/spFiltro"
+        android:layout_width="0dp"
+        android:layout_height="48dp"
+        android:layout_marginTop="8dp"
+        app:layout_constraintStart_toEndOf="@+id/imageView3"
+        app:layout_constraintTop_toBottomOf="@+id/txtNomeEmpresa" />
+
 </androidx.constraintlayout.widget.ConstraintLayout>
\ No newline at end of file
-- 
2.41.0

